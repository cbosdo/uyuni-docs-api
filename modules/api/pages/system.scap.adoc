


[#system_scap]
== system.scap


=== Available methods

* <<system_scap-deleteXccdfScan,deleteXccdfScan>>
* <<system_scap-getXccdfScanDetails,getXccdfScanDetails>>
* <<system_scap-getXccdfScanRuleResults,getXccdfScanRuleResults>>
* <<system_scap-listXccdfScans,listXccdfScans>>
* <<system_scap-scheduleXccdfScan,scheduleXccdfScan>>
* <<system_scap-scheduleXccdfScan,scheduleXccdfScan>>
* <<system_scap-scheduleXccdfScan,scheduleXccdfScan>>
* <<system_scap-scheduleXccdfScan,scheduleXccdfScan>>

=== Description

Provides methods to schedule SCAP scans and access the results.

*Namespace*:

system.scap

'''


[#system_scap-deleteXccdfScan]
=== Method: deleteXccdfScan 

Description:

Delete OpenSCAP XCCDF Scan from Spacewalk database. Note that
 only those SCAP Scans can be deleted which have passed their retention period.




Parameters:

  * [.string]#string#  sessionKey
 
* [.int]#int#  Id of XCCDF scan (xid).
 

Returns:

* boolean - indicates success of the operation. 
 


'''


[#system_scap-getXccdfScanDetails]
=== Method: getXccdfScanDetails 

Description:

Get details of given OpenSCAP XCCDF scan.




Parameters:

  * [.string]#string#  sessionKey
 
* [.int]#int#  Id of XCCDF scan (xid).
 

Returns:

* * [.struct]#struct#  - OpenSCAP XCCDF Scan
   * [.int]#int#  "xid" - XCCDF TestResult id
   * [.int]#int#  "sid" - serverId
   * [.int]#int#  "action_id" - Id of the parent action.
   * [.string]#string#  "path" - Path to XCCDF document
   * [.string]#string#  "oscap_parameters" - oscap command-line arguments.
   * [.string]#string#  "test_result" - Identifier of XCCDF TestResult.
   * [.string]#string#  "benchmark" - Identifier of XCCDF Benchmark.
   * [.string]#string#  "benchmark_version" - Version of the Benchmark.
   * [.string]#string#  "profile" - Identifier of XCCDF Profile.
   * [.string]#string#  "profile_title" - Title of XCCDF Profile.
   * [.dateTime.iso8601]#dateTime.iso8601#  "start_time" - Client machine time of scan start.
   * [.dateTime.iso8601]#dateTime.iso8601#  "end_time" - Client machine time of scan completion.
   * [.string]#string#  "errors" - Stderr output of scan.
   * [.boolean]#boolean#  "deletable" - Indicates whether the scan can be deleted.
 // no end needed
  
 


'''


[#system_scap-getXccdfScanRuleResults]
=== Method: getXccdfScanRuleResults 

Description:

Return a full list of RuleResults for given OpenSCAP XCCDF scan.




Parameters:

  * [.string]#string#  sessionKey
 
* [.int]#int#  Id of XCCDF scan (xid).
 

Returns:

* [.array]#array# :
   * [.struct]#struct#  - OpenSCAP XCCDF RuleResult
   * [.string]#string#  "idref" - idref from XCCDF document.
   * [.string]#string#  "result" - Result of evaluation.
   * [.string]#string#  "idents" - Comma separated list of XCCDF idents.
 // no end needed
 
 // no end needed
 


'''


[#system_scap-listXccdfScans]
=== Method: listXccdfScans 

Description:

Return a list of finished OpenSCAP scans for a given system.




Parameters:

  * [.string]#string#  sessionKey
 
* [.int]#int#  serverId
 

Returns:

* [.array]#array# :
   * [.struct]#struct#  - OpenSCAP XCCDF Scan
   * [.int]#int#  "xid" - XCCDF TestResult ID
   * [.string]#string#  "profile" - XCCDF Profile
   * [.string]#string#  "path" - Path to XCCDF document
   * [.dateTime.iso8601]#dateTime.iso8601#  "completed" - Scan completion time
 // no end needed
 
 // no end needed
 


'''


[#system_scap-scheduleXccdfScan]
=== Method: scheduleXccdfScan 

Description:

Schedule OpenSCAP scan.




Parameters:

  * [.string]#string#  sessionKey
 
* [.array]#array# :
** int - serverId
 
* [.string]#string#  Path to xccdf content on targeted systems.
 
* [.string]#string#  Additional parameters for oscap tool.
 

Returns:

* int - ID if SCAP action created. 
 


'''


[#system_scap-scheduleXccdfScan]
=== Method: scheduleXccdfScan 

Description:

Schedule OpenSCAP scan.




Parameters:

  * [.string]#string#  sessionKey
 
* [.array]#array# :
** int - serverId
 
* [.string]#string#  Path to xccdf content on targeted systems.
 
* [.string]#string#  Additional parameters for oscap tool.
 
* [.dateTime.iso8601]#dateTime.iso8601#  date - The date to schedule the action
 

Returns:

* int - ID if SCAP action created. 
 


'''


[#system_scap-scheduleXccdfScan]
=== Method: scheduleXccdfScan 

Description:

Schedule Scap XCCDF scan.




Parameters:

  * [.string]#string#  sessionKey
 
* [.int]#int#  serverId
 
* [.string]#string#  Path to xccdf content on targeted system.
 
* [.string]#string#  Additional parameters for oscap tool.
 

Returns:

* int - ID of the scap action created. 
 


'''


[#system_scap-scheduleXccdfScan]
=== Method: scheduleXccdfScan 

Description:

Schedule Scap XCCDF scan.




Parameters:

  * [.string]#string#  sessionKey
 
* [.int]#int#  serverId
 
* [.string]#string#  Path to xccdf content on targeted system.
 
* [.string]#string#  Additional parameters for oscap tool.
 
* [.dateTime.iso8601]#dateTime.iso8601#  date - The date to schedule the action
 

Returns:

* int - ID of the scap action created. 
 


'''

